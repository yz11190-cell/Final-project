# Final-project
Predicting S&P 500 Stock Outperformance Using Financial Indicators
Introduction
This project focuses on building a predictive model to determine whether a stock in the S&P 500 will outperform the overall market, measured by the SPDR S&P 500 ETF (SPY), over a future 12-month period. The predictive task is framed as a binary classification problem, where a stock is labeled as outperforming if its forward 12-month return exceeds that of SPY, and underperforming otherwise.
Using firm-level financial indicators, the project aims to assess whether company fundamentals contain meaningful information for predicting relative stock performance. Several supervised learning models are trained and compared, and their performance is evaluated using appropriate classification metrics. The results show that while predicting market outperformance is challenging, financial fundamentals do provide some predictive signal.

Data Description
The dataset is constructed from two main sources. First, the list of S&P 500 constituent companies is obtained from Wikipedia. Second, firm-level financial data and historical stock prices are collected using the yfinance library.
The financial features include valuation measures (such as price-to-book ratios), profitability metrics (profit margins, return on equity, return on assets), leverage and balance-sheet indicators (total debt, cash, enterprise value), and risk measures such as beta. Several additional ratio-based features are engineered, including debt-to-market-capitalization and free-cash-flow-to-market-capitalization, to allow for easier comparison across firms of different sizes.
Historical adjusted closing prices are used to compute forward 12-month returns for each stock and for SPY. After cleaning and merging the data, the final modeling dataset contains 499 observations, with a moderate amount of missing data in certain financial variables, which is handled through median imputation during model training.
Models and Methods
The predictive task is defined as follows: a stock receives a label of 1 if its forward 12-month return is greater than SPY’s forward 12-month return, and 0 otherwise. Because outperforming the market is less common, the resulting dataset is imbalanced, with more underperforming stocks than outperforming ones.
Before modeling, categorical variables such as sector are converted into numerical form using one-hot encoding. The dataset is then split into training and testing sets using a stratified train-test split to preserve class proportions.
Several classification models are trained and evaluated, including Logistic Regression, K-Nearest Neighbors, Decision Trees, Random Forests, and Gradient Boosting. To ensure consistent preprocessing, pipelines are used to apply median imputation and feature scaling where appropriate. Model performance is evaluated using accuracy, precision, recall, F1 score, and ROC-AUC, with particular emphasis on ROC-AUC and F1 due to class imbalance.

Results and Interpretation
Model comparison shows that Logistic Regression and Gradient Boosting perform best overall among the models tested. Logistic Regression achieves the highest ROC-AUC (approximately 0.75), indicating a stronger ability to distinguish between stocks that outperform SPY and those that do not across different classification thresholds. Gradient Boosting achieves the highest accuracy and F1 score, suggesting a better balance between precision and recall at a specific threshold.
Across all models, recall values are relatively low, reflecting the difficulty of correctly identifying stocks that outperform the market. This outcome is expected given the inherent challenge of beating a broad market index and the imbalance in the target variable. As a result, accuracy alone is not sufficient to assess performance, and metrics such as ROC-AUC and F1 provide more meaningful insight.
Further analysis of the best-performing Logistic Regression model shows that it is conservative in its predictions. The confusion matrix indicates that the model correctly identifies most underperforming stocks but misses a substantial portion of outperforming ones. However, the ROC curve demonstrates that the model still captures useful ranking information, as reflected by its ROC-AUC score.
Feature coefficient analysis suggests that firm size, valuation, and growth-related variables play an important role in the model’s predictions. Variables related to enterprise value, revenue, free cash flow, and earnings growth are positively associated with outperformance, while higher debt levels and certain profitability measures show negative associations. These relationships should be interpreted as correlations rather than causal effects.

Conclusion and Next Steps
In this project, we developed and evaluated predictive models to classify whether S&P 500 stocks would outperform SPY over a 12-month horizon using firm-level financial indicators. The results suggest that financial fundamentals contain some predictive information, with Logistic Regression and Gradient Boosting models performing best overall. However, predictive performance remains limited, highlighting the difficulty of consistently forecasting market outperformance.
There are several limitations to this analysis. Financial data obtained from yfinance represents a snapshot rather than time-stamped historical fundamentals, which may introduce misalignment between features and returns. Additionally, stock performance is influenced by many external factors not captured in firm-level financial data alone.
Future work could improve this analysis by incorporating time-stamped financial statements, expanding the study across multiple time periods, adding macroeconomic variables, and exploring alternative modeling approaches. These extensions could help improve robustness and provide deeper insight into the drivers of relative stock performance.
